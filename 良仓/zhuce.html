<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<link rel="shortcut icon" href="img/favicon.ico" /> 
		<title>用户注册</title>
		<link rel="stylesheet" href="css/common.css" />
		<link rel="stylesheet" href="css/zhuce.css" />
		<link rel="stylesheet" href="css/jquery.idcode.css" />
		<script type="text/javascript" src="js/jquery-3.2.1.js" ></script>
		<script type="text/javascript" src="js/jquery.idcode.js" ></script>
	</head>
	<body>
		<div id="wrapper">
			<div id="header">
				<a href="#">
						<img src="img/logo_icon.png"  class="img" />
				</a>						
				<table>		
					<tr height="50">
						<th class="th" width="30%">用户名</th>
						<td class="td"><input id="username" type="text" placeholder="请输入用户名" /><span id="spanuser" style="color: #fff;"></span></td>
					</tr>
					<tr height="50">
						<th class="th" width="30%">验证码</th>
						<td class="idcode"><input type="text" id ="Txtidcode" placeholder="输入验证码" /><span id="idcode"></span></td>
					</tr>
					<tr height="50">
						<th class="th" width="30%">创建密码</th>
						<td class="td"><input id="mima" type="password" placeholder="6-12位字符组成，区分大小写" /><span id="spanpassw" style="color: #fff;"></span></td>
					</tr>
					<tr height="50">
						<th class="th" width="30%">确认密码</th>
						<td class="td"><input type="password" id="mimaqr" placeholder="确认密码" /><span id="spanpasswqr" style="color: #fff;"></span></td>
					</tr>
					
				</table>
			</div>
			<div id="container">
				<input type="checkbox" checked="checked" class="check" /><p>同意<a href="http://www.iliangcang.com/i/our/service">良仓注册条款</a></p>
				<button id="btn">立即注册</button>
			</div>		
			<div id="footer">
				<a>
					<img src="img/qqnormal.png"  />
				</a>
				<a>
					<img src="img/xinlangnormal.png"  />	
				</a>
				<a>
					<img src="img/doubannormal.png"  /> 
				</a>
				<a>
					<img src="img/tengxunnormal.png"  /> 
				</a>
				<a href="">登录良仓</a>
		
			</div>								
		</div>
		<div id="right">
			<p class="name">ferm LIVING</p>
			<img src="img/60.jpg"  width="40px" height="40px" /> 
		</div>
	</body>
	
	<script type="text/javascript">		
		$(function  () {
			var oUsername = $("#username");
		    var oPassw = $("#mima");
		    var oPspan = $("#spanpassw");
		    var oSpan = $("#spanuser");		    		    
		    var reg = /[0-9A-z_]+/;
		    var oPasswqr = $("#mimaqr");
		    var oPassqr = $("#spanpasswqr");
		    var oBtn = $("#btn")
		    //验证用户名
	        oUsername.blur(function () {
		        username = oUsername.val();
		        console.log(username);
		        var url = "http://h6.duchengjiu.top/shop/api_user.php"
		        var data = {
		        	"status": "check",
		            "username": username
		        }
		        $.post(url, data, function(obj) {
	                if(obj.code === 0){
                        oSpan.html("用户名可用");
                    }else if(obj.code === 2001){
                        oSpan.html("用户名已存在");
                    }
	            })
		        if(username === ""){
		            oSpan.html("请输入用户名！");
		            return;
		        }else if(username.length > 20 || username.length < 3){
		            oSpan.html("用户名错误，规定在3-20位数字字母下划线");
		            return;		        		            
		        }else{
		            oSpan.html("用户名错误，不能使用特殊字符");
		            return;
		        }
    		});
			//验证密码
			
			oPassw.blur(function () {
			   
               password = oPassw.val();
		        if(password === ""){
		            oPspan.html("请输入密码!");
		            return;
		        }else if(password.length > 20 || password.length < 6){
		            oPspan.html("用户密码错误，规定在6-20位之间,数字字母下划线");
		            return;
		        }else if(reg.test(password)){
		            oPspan.html("用户密码可用");
		        }else{
		            oPspan.html("用户密码错误，不能使用特殊字符");
		            return;
		        }
		    });
		    oPasswqr.blur(function () {			   
               passwordqr = oPasswqr.val();
		        if(passwordqr === ""){
		            oPassqr.html("请输入确认密码!");
		            return;
		        }else if(passwordqr == password){
		            oPassqr.html("确认成功");
		            return;
		        }else{
		            oPassqr.html("密码不一致");
		            return;
		        }
		    });
		    //验证码请求
			$.idcode.setCode();			
			$("#Txtidcode").change(function() {
				var r = $.idcode.validateCode();				
				if (r == true) {						
				} else {
					alert("验证码错误！")
				}
			})				
			
		    //注册按钮验证
		    oBtn.click(function  () {
		    	if (oSpan.innerHTML = "用户名可用" && oPassqr.innerHTML =="确认成功") {
		    		console.log(oBtn)
		    		alert("注册成功")
//		    		<link href = 
		    	}else{
		    		alert("注册失败")
		    	}
		    })
		
	})
			
		
			
		
	</script>
</html>
